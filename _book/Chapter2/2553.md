## 2553 N皇后问题

### 一、题目

#### 问题描述

>   在N*N的方格棋盘放置了N个皇后，使得它们不相互攻击（即任意2个皇后不允许处在同一排，同一列，也不允许处在与棋盘边框成45角的斜线上。
>   你的任务是，对于给定的N，求出有多少种合法的放置方法。

#### 输入数据

>   共有若干行，每行一个正整数N≤10，表示棋盘和皇后的数量；如果N=0，表示结束。

#### 输出数据

>  共有若干行，每行一个正整数，表示对应输入行的皇后的不同放置数量。

#### 输入样例

>   1 
>   8
>   5
>   0

#### 输出样例

>  1
>  92
>  10

#### 题目来源

> HDU 2553 http://acm.hdu.edu.cn/showproblem.php?pid=2553

### 二、题解

#### 解题思路

 回溯法的经典入门题目

下面我们对问题进行分析：

1.一行只能放一个皇后，所以我们一旦确定此处可以放皇后，那么该行就只能放一个皇后，下面的就不要再搜了。

2.每一列只能放一个皇后，所以我们下次搜索就不要再搜已经放过的皇后了。

3.斜的45°线也只能放一个。

综上如何才能最快速的确定一列和45°是否用过这个是个关键步骤，一旦此步骤确定我们就可以很快的进行搜索了。

我们用三个数组来保存他的每一个状态及（三个方向 ↖ ↑ ↗）

但是如果我们保存↑（每一列方向上的皇后）是非常容易保存的 但是保存（ 这两个方向上的状态就不容易了↖ ↗）

再分析，在这个（↖）方向上的数据的行和列有什么特点

 0  1  2  3   4

-1  0  1  2  3

-2 -1  0  1  2

-3 -2 -1  0  1

-4 -3 -2 -1  0 

将此表列出我们就应该知道在（↖）方向上的数据的行和列的特点了，及   在 （↖）方向上  列 - 行 的差是相等的。

假如我们用数组保存负数肯定是不行的， 所以我们要加上 n,让他变为非负.

再分析，在这个（ ↗）方向上的数据的行和列有什么特点

0 1 2 3 4

1 2 3 4 5

2 3 4 5 6

3 4 5 6 7

将此表列出我们就应该知道在（↗）方向上的数据的行和列的特点了，及   在 （↗）方向上  列 + 行 的和是相等的。

知道数据怎么处理就可以解决问题了

#### 参考程序

```C
//八皇后问题 回溯法
#include<stdio.h>
int tot=0,row,line[10],n;
int main()
{
    void search(int );
    int a[11];
    for(n=1;n<=10;n++) //之前就是没有这一步预处理，所以TLE了 TT
    {
        tot=0;
        search(0);
        a[n]=tot;
    }
    while(scanf("%d",&n)!=EOF&&n)
         printf("%d\n",a[n]);
    return 0;
}
void search(int row) //递归搜索可行解
{
    int i,j;
     if(row==n) tot++; //当row=n时，说明每一行的皇后都不冲突，即为可行解
     else
     for(i=0;i<n;i++)
     {
         int ok=1;
         line[row]=i; //尝试把第row行的皇后放在i列上
         for(j=0;j<row;j++) //检验是否与前面已放好的皇后冲突
         {
             if(line[row]==line[j]||line[row]-row==line[j]-j||line[row]+row==line[j]+j)
             {
                 ok=0; 
                 break; //，跳出最内层循环如果冲突，停止搜索，返回上一级递归回溯。回溯法高效的关键。
             }
         }
         if(ok)
             search(row+1);
     }
}
```

#### 复杂度分析

无

#### 编程技巧

无